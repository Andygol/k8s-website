---
reviewers:
- mtaufen
- dawnchen
title: Встановлення параметрів Kubelet через файл конфігурації
content_type: task
weight: 330
---

<!-- overview -->

Частину параметрів конфігурації kubelet можна встановити за допомогою конфігураційного файлу на диску, як альтернативу командним прапорцям.

Надання параметрів через файл конфігурації є рекомендованим підходом, оскільки це спрощує розгортання вузлів та управління конфігурацією.

<!-- steps -->

## Створіть файл конфігурації {#create-the-config-file}

Підмножина конфігурації kubelet, яку можна налаштувати через файл, визначається структурою [`KubeletConfiguration`](/docs/reference/config-api/kubelet-config.v1beta1/).

Файл конфігурації повинен бути у форматі JSON або YAML, який представляє параметри цієї структури. Переконайтеся, що у kubelet є права для читання файлу.

Ось приклад того, як може виглядати цей файл:

```yaml
apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: "192.168.0.8"
port: 20250
serializeImagePulls: false
evictionHard:
    memory.available:  "100Mi"
    nodefs.available:  "10%"
    nodefs.inodesFree: "5%"
    imagefs.available: "15%"
```

У цьому прикладі kubelet налаштовано з наступними параметрами:

1. `address`: Kubelet буде доступний за IP-адресою `192.168.0.8`.
2. `port`: Kubelet буде слухати порт `20250`.
3. `serializeImagePulls`: Завантаження образів виконуватиметься паралельно.
4. `evictionHard`: Kubelet буде виселяти Pod'и за однією з наступних умов:
   - Коли доступна памʼять вузла впаде нижче 100 МіБ.
   - Коли доступний простір основної файлової системи вузла менше 10%.
   - Коли доступний простір файлової системи образів менше 15%.
   - Коли більше ніж 95% inodes основної файлової системи вузла використано.

{{< note >}}
У прикладі, змінюючи лише один типовий параметр для `evictionHard`, типові значення інших параметрів не будуть успадковані та будуть встановлені в нуль. Щоб надати власні значення, вам слід надати всі порогові значення відповідно.
{{< /note >}}

`imagefs` — це опціональна файлова система, яку середовища виконання контейнерів використовують для зберігання образів контейнерів та записуваних шарів контейнерів.

## Запуск процесу kubelet, налаштованого через файл конфігурації {#start-a-kubelet-process-configured-via-the-config-file}

{{< note >}}
Якщо ви використовуєте kubeadm для ініціалізації кластера, використовуйте kubelet-config під час створення вашого кластера за допомогою `kubeadm init`. Дивіться [налаштування kubelet за допомогою kubeadm](/docs/setup/production-environment/tools/kubeadm/kubelet-integration/) для деталей.
{{< /note >}}

Запустіть kubelet з параметром `--config`, вказавши шлях до файлу конфігурації kubelet. Після цього kubelet завантажить свою конфігурацію з цього файлу.

Зверніть увагу, що параметри командного рядка, які стосуються того ж значення, що й файл конфігурації, перекриватимуть це значення. Це допомагає забезпечити зворотну сумісність з API командного рядка.

Також зверніть увагу, що відносні шляхи файлів у файлі конфігурації kubelet розглядаються відносно місця розташування файлу конфігурації kubelet, тоді як відносні шляхи в параметрах командного рядка розглядаються відносно поточної робочої теки kubelet.

Зауважте, що деякі типові значення відрізняються між параметрами командного рядка та файлом конфігурації kubelet. Якщо наданий параметр `--config` і значення не вказані через командний рядок, то застосовуються типові значення для версії `KubeletConfiguration`. У згаданому вище прикладі ця версія є `kubelet.config.k8s.io/v1beta1`.

## Тека для файлів конфігурації kubelet {#kubelet-conf-d}

Починаючи з Kubernetes версії 1.28.0, можливості kubelet були розширені для підтримки теки drop-in конфігурації. Її місцеположення можна вказати за допомогою параметра `--config-dir`, який типово встановлено в значення `""` і відключено.

Ви можете встановити `--config-dir` лише якщо задана змінна середовища `KUBELET_CONFIG_DROPIN_DIR_ALPHA` для процесу kubelet (значення цієї змінної не має значення). Для Kubernetes v{{< skew currentVersion >}}, kubelet поверне помилку, якщо ви вкажете `--config-dir` без цієї змінної, і запуск завершиться збоєм. Ви не можете вказати теку drop-in конфігурації за допомогою файлу конфігурації kubelet; тільки аргумент командного рядка `--config-dir` може це встановити.

Теку конфігурації kubelet можна використовувати подібно до файлу конфігурації kubelet.
{{< note >}}
Суфікс файлу конфігурації drop-in для kubelet має бути `.conf`. Наприклад: `99-kubelet-address.conf`
{{< /note >}}

Наприклад, ви бажаєте мати базову конфігурацію kubelet для всіх вузлів, але вам може знадобитись налаштувати поле `address`. Це можна зробити так:

Вміст основного файлу конфігурації kubelet:

```yaml
apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
port: 20250
serializeImagePulls: false
evictionHard:
    memory.available:  "200Mi"
```

Вміст файлу в теці `--config-dir`:

```yaml
apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
address: "192.168.0.8"
```

Під час запуску kubelet обʼєднує конфігурацію з:

- Параметри командного рядка (найнижчий пріоритет).
- Конфігурація kubelet
- Drop-in файли конфігурації відповідно до порядку сортування.
- Feature gate, вказані через командний рядок (найвищий пріоритет).

Це призводить до такого ж результату, як якби ви використовували [один конфігураційний файл](#create-the-config-file) з попереднього прикладу.

<!-- discussion -->

## {{% heading "whatsnext" %}}

- Дізнайтеся більше про конфігурацію kubelet, переглянувши
  [довідник `KubeletConfiguration`](/docs/reference/config-api/kubelet-config.v1beta1/).
